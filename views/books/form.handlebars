<h1>New Book</h1>
<form action="/books/upsert" role="form" method="post">
  <input type="hidden" name="_csrf" value="{{_csrfToken}}">

  {{#if book}}
  <div>
    <h2>{{book.title}} {{book.yeaar}}</h2>
    <input type="hidden" name="id" value="{{bookIndex}}">
  </div>
  {{/if}}
  <div>
    <label for="title">Title</label>
    <input type="text" id="title" name="title" {{#if book}}value="{{book.title}}" {{/if}}>
  </div>
  <div>
    <label for="year">Published Year</label>
    <input type="text" id="year" name="year" {{#if book}}value="{{book.year}}" {{/if}}>
  </div>


  <div class="mb-3">
    <label for="authorId">Author</label>
    <select name="authorIds" multiple id="authorIds">
      <option disabled value>-- select Author --</option>
      {{#each authors}}
      <option value="{{@index}}" {{#if (and @root.book (in @root.book.authorIds @index))}}selected{{/if}}>
        {{this.firstName}} {{this.lastName}}
      </option>
      {{/each}}
    </select>
  </div>

  <div class="mb-3">
    <label for="genreId">Genre</label>
    <select name="genreId" id="genreId">
      <option disabled selected value>-- select Genre --</option>
      {{#each genres}}
      <option value="{{@index}}" {{#if (and @root.book (eq @root.book.genreId @index))}}selected{{/if}}>
        {{this.genreName}}
      </option>
      {{/each}}
    </select>
  </div>
  <button type="submit" class="btn btn-primary">Submit</button>
</form>